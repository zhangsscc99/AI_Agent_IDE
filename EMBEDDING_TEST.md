# 🧪 Codebase Embedding 测试清单

## ✅ 测试步骤

### 1. 准备测试环境

- [x] 依赖已安装
- [x] API Key 已配置
- [ ] 启动开发服务器

```bash
npm run dev
```

### 2. 创建测试文件

在 AI 对话框中输入：

```
创建一个文件 test_auth.ts，包含用户认证函数
```

```
创建一个文件 test_upload.ts，包含文件上传处理
```

```
创建一个文件 test_database.ts，包含数据库连接
```

### 3. 索引代码库

1. 点击文件浏览器顶部的 **🔍 搜索图标**
2. 等待提示："✅ 代码库索引完成！"

### 4. 测试搜索功能

#### 测试 1：基础搜索

**输入：**
```
在哪里处理用户认证？
```

**预期结果：**
- 显示搜索结果卡片
- 找到 `test_auth.ts` 文件
- 相似度 > 70%

#### 测试 2：智能修改（无需指定文件）

**输入：**
```
给文件上传功能添加日志
```

**预期结果：**
1. AI 自动搜索 "file upload"
2. 找到 `test_upload.ts`
3. 读取文件
4. 显示修改的 Diff
5. 等待用户确认

#### 测试 3：多文件查找

**输入：**
```
这个项目有哪些主要功能？
```

**预期结果：**
- AI 搜索代码库
- 列出找到的多个文件
- 总结项目功能

---

## 🎯 验收标准

### 功能性测试

- [ ] 索引按钮可点击
- [ ] 索引进度正确显示
- [ ] 索引完成后有提示
- [ ] 搜索结果正确显示
- [ ] AI 自动调用搜索工具
- [ ] 搜索结果格式正确
- [ ] 相似度百分比显示
- [ ] 代码预览可见

### 性能测试

- [ ] 10 个文件索引 < 10 秒
- [ ] 搜索响应 < 2 秒
- [ ] 无内存泄漏
- [ ] UI 不卡顿

### 错误处理

- [ ] API Key 错误时有提示
- [ ] 网络错误时有提示
- [ ] 搜索无结果时有提示
- [ ] 未索引时有友好提示

---

## 🐛 已知问题

### Issue 1: ChromaDB 兼容性

**问题：** ChromaDB 可能需要额外配置

**解决方案：** 确保 Node.js 版本 >= 18

### Issue 2: GLM Embedding API

**问题：** GLM embedding-2 模型调用

**状态：** 已实现，需要验证

---

## 📝 测试记录

### 测试环境

- OS: Windows 11
- Node.js: v20.x
- npm: v10.x
- 浏览器: Chrome

### 测试日期

- 实现完成：2025-12-14

### 测试结果

测试项 | 状态 | 备注
-------|------|------
依赖安装 | ✅ | 
类型定义 | ✅ | 
API 路由 | ✅ | 
工具集成 | ✅ | 
前端界面 | ✅ | 
索引功能 | ⏳ | 待用户测试
搜索功能 | ⏳ | 待用户测试
智能推荐 | ⏳ | 待用户测试

---

## 🚀 下一步

完成基础测试后，可以尝试：

1. **真实项目测试** - 索引整个 AI_Agent 项目
2. **性能优化** - 大量文件时的索引速度
3. **用户体验** - 搜索结果的展示效果

---

**准备好开始测试了！** 🎉

