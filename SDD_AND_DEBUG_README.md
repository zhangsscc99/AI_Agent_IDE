# SDD (Spec Driven Development) å’Œè°ƒè¯•è¿½è¸ªåŠŸèƒ½

## ğŸ‰ æ–°åŠŸèƒ½æ¦‚è¿°

æœ¬é¡¹ç›®æ–°å¢äº†ä¸¤ä¸ªå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¸®åŠ©ä½ æ›´é«˜æ•ˆåœ°å¼€å‘å’Œè°ƒè¯•ï¼š

### 1. SDD (Spec Driven Development) - è§„æ ¼é©±åŠ¨å¼€å‘

é€šè¿‡å®šä¹‰è§„æ ¼æ–‡ä»¶ï¼Œè‡ªåŠ¨ç”Ÿæˆä»£ç ã€æµ‹è¯•å’Œæ–‡æ¡£ã€‚

**æ ¸å¿ƒä¼˜åŠ¿ï¼š**
- âœ… æé«˜ä»£ç è´¨é‡å’Œä¸€è‡´æ€§
- âœ… å‡å°‘æ²Ÿé€šæˆæœ¬
- âœ… è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
- âœ… æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ˆTypeScriptã€Python ç­‰ï¼‰

### 2. è°ƒè¯•è¿½è¸ªç³»ç»Ÿ (Debug Tracer)

è®°å½• Agent æ‰§è¡Œçš„æ¯ä¸€æ­¥ï¼Œæä¾›å®Œæ•´çš„è°ƒè¯•ä¿¡æ¯ã€‚

**æ ¸å¿ƒä¼˜åŠ¿ï¼š**
- ğŸ” å¯è§†åŒ– Agent å†³ç­–è¿‡ç¨‹
- â±ï¸ æ€§èƒ½åˆ†æå’Œä¼˜åŒ–
- ğŸ“Š Token ä½¿ç”¨ç»Ÿè®¡
- ğŸ› å¿«é€Ÿå®šä½é—®é¢˜

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
npm install
```

æ–°å¢çš„ä¾èµ–åŒ…æ‹¬ï¼š
- `js-yaml`: ç”¨äºå¤„ç† YAML æ ¼å¼çš„è§„æ ¼æ–‡ä»¶
- `@types/js-yaml`: TypeScript ç±»å‹å®šä¹‰

### ä½¿ç”¨ SDD

#### 1. åˆ›å»ºè§„æ ¼æ–‡ä»¶

åœ¨ AI Agent å¯¹è¯æ¡†ä¸­è¾“å…¥ï¼š

```
åˆ›å»ºä¸€ä¸ªè®¡ç®—å™¨æ¨¡å—çš„è§„æ ¼ï¼ŒåŒ…å« addã€subtractã€multiplyã€divide å‡½æ•°
```

Agent ä¼šç”Ÿæˆç±»ä¼¼è¿™æ ·çš„è§„æ ¼æ–‡ä»¶ï¼š

```yaml
name: calculator
version: 1.0.0
description: åŸºæœ¬è®¡ç®—å™¨æ¨¡å—

functions:
  - name: add
    description: ä¸¤ä¸ªæ•°ç›¸åŠ 
    parameters:
      - name: a
        type: number
        required: true
      - name: b
        type: number
        required: true
    returns:
      type: number
      description: ä¸¤æ•°ä¹‹å’Œ
    examples:
      - input: { a: 2, b: 3 }
        output: 5
```

#### 2. ä»è§„æ ¼ç”Ÿæˆä»£ç 

```
ä» calculator.spec.yaml ç”Ÿæˆ TypeScript ä»£ç åˆ° src/calculator.ts
```

Agent ä¼šç”Ÿæˆï¼š
- âœ… å®Œæ•´çš„ TypeScript ä»£ç 
- âœ… å•å…ƒæµ‹è¯•æ–‡ä»¶
- âœ… å‡½æ•°æ–‡æ¡£æ³¨é‡Š

#### 3. éªŒè¯è§„æ ¼

```
éªŒè¯ calculator.spec.yaml æ˜¯å¦æœ‰æ•ˆ
```

### ä½¿ç”¨è°ƒè¯•è¿½è¸ª

#### 1. å¯ç”¨è°ƒè¯•

ä¿®æ”¹ `app/api/agent/chat/route.ts`ï¼š

```typescript
const executor = new AgentExecutor({
  sessionId,
  workspacePath,
  llmClient,
  enableDebug: true  // å¯ç”¨è°ƒè¯•è¿½è¸ª
});
```

#### 2. æŸ¥çœ‹è°ƒè¯•æ•°æ®

```typescript
// è·å–è°ƒè¯•ä¿¡æ¯
const response = await fetch(`/api/debug/trace?sessionId=${sessionId}`);
const { session } = await response.json();

// æ‰“å°ç»Ÿè®¡ä¿¡æ¯
console.log('ä¼šè¯æ‘˜è¦:', {
  duration: session.summary.totalDuration + 'ms',
  llmCalls: session.summary.llmCalls,
  toolCalls: session.summary.toolCalls,
  tokens: session.summary.tokensUsed.total
});
```

#### 3. ä½¿ç”¨è°ƒè¯•é¢æ¿

åœ¨å‰ç«¯ç•Œé¢ä¸­é›†æˆ `DebugPanel` ç»„ä»¶ï¼š

```tsx
import { DebugPanel } from '@/components/DebugPanel';

function App() {
  return (
    <div>
      <DebugPanel session={debugSession} />
    </div>
  );
}
```

## ğŸ“š å¯ç”¨çš„ Agent å·¥å…·

### SDD å·¥å…·

| å·¥å…·åç§° | åŠŸèƒ½ | ç¤ºä¾‹ |
|---------|------|------|
| `create_spec` | åˆ›å»ºè§„æ ¼æ–‡ä»¶ | "åˆ›å»ºä¸€ä¸ªç”¨æˆ·ç®¡ç†æ¨¡å—çš„è§„æ ¼" |
| `read_spec` | è¯»å–è§„æ ¼æ–‡ä»¶ | "è¯»å– user.spec.yaml" |
| `list_specs` | åˆ—å‡ºæ‰€æœ‰è§„æ ¼ | "åˆ—å‡ºæ‰€æœ‰è§„æ ¼æ–‡ä»¶" |
| `validate_spec` | éªŒè¯è§„æ ¼ | "éªŒè¯ user.spec.yaml" |
| `generate_code_from_spec` | ç”Ÿæˆä»£ç  | "ä» user.spec.yaml ç”Ÿæˆä»£ç " |
| `infer_spec_from_code` | ä»ä»£ç æ¨æ–­è§„æ ¼ | "åˆ†æ utils.ts å¹¶ç”Ÿæˆè§„æ ¼" |

### è°ƒè¯•å·¥å…·

è°ƒè¯•åŠŸèƒ½ä¼šè‡ªåŠ¨è®°å½•ï¼š
- LLM è°ƒç”¨å’Œå“åº”
- å·¥å…·è°ƒç”¨å’Œç»“æœ
- Agent æ€è€ƒè¿‡ç¨‹
- é”™è¯¯å’Œå¼‚å¸¸
- æ€§èƒ½ç»Ÿè®¡

## ğŸ“ é¡¹ç›®ç»“æ„

```
AI_Agent_IDE/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ sdd/                    # SDD åŠŸèƒ½æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ types.ts            # ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ spec-manager.ts     # è§„æ ¼ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ code-generator.ts   # ä»£ç ç”Ÿæˆå™¨
â”‚   â”‚   â””â”€â”€ spec-tools.ts       # Agent å·¥å…·
â”‚   â”œâ”€â”€ debug/                  # è°ƒè¯•åŠŸèƒ½æ¨¡å—
â”‚   â”‚   â””â”€â”€ tracer.ts           # è°ƒè¯•è¿½è¸ªå™¨
â”‚   â””â”€â”€ agent/
â”‚       â”œâ”€â”€ executor.ts         # Agent æ‰§è¡Œå™¨ï¼ˆå·²é›†æˆè°ƒè¯•ï¼‰
â”‚       â””â”€â”€ tools.ts            # å·¥å…·ç³»ç»Ÿï¼ˆå·²é›†æˆ SDD å·¥å…·ï¼‰
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ DebugPanel.tsx          # è°ƒè¯•é¢æ¿ç»„ä»¶
â”‚   â””â”€â”€ SpecViewer.tsx          # è§„æ ¼æŸ¥çœ‹å™¨ç»„ä»¶
â”œâ”€â”€ app/api/
â”‚   â”œâ”€â”€ debug/
â”‚   â”‚   â””â”€â”€ trace/
â”‚   â”‚       â””â”€â”€ route.ts        # è°ƒè¯• API
â”‚   â””â”€â”€ spec/
â”‚       â””â”€â”€ route.ts            # è§„æ ¼ API
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ SDD_GUIDE.md            # SDD è¯¦ç»†æŒ‡å—
â”‚   â””â”€â”€ DEBUG_GUIDE.md          # è°ƒè¯•è¿½è¸ªæŒ‡å—
â””â”€â”€ examples/
    â”œâ”€â”€ calculator.spec.yaml    # è®¡ç®—å™¨è§„æ ¼ç¤ºä¾‹
    â”œâ”€â”€ user_manager.spec.yaml  # ç”¨æˆ·ç®¡ç†è§„æ ¼ç¤ºä¾‹
    â””â”€â”€ EXAMPLES.md             # ç¤ºä¾‹è¯´æ˜
```

## ğŸ’¡ ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šå›¢é˜Ÿåä½œ

1. äº§å“ç»ç†å®šä¹‰åŠŸèƒ½è§„æ ¼
2. å‰åç«¯å›¢é˜Ÿè¯„å®¡è§„æ ¼
3. è‡ªåŠ¨ç”Ÿæˆä»£ç æ¡†æ¶
4. å›¢é˜Ÿå¹¶è¡Œå¼€å‘
5. ç»Ÿä¸€çš„æ¥å£å®šä¹‰

### åœºæ™¯ 2ï¼šAPI è®¾è®¡

1. è®¾è®¡ API è§„æ ¼
2. ç”Ÿæˆæ¥å£å®šä¹‰
3. ç”Ÿæˆå®¢æˆ·ç«¯ä»£ç 
4. ç”ŸæˆæœåŠ¡ç«¯ä»£ç 
5. è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£

### åœºæ™¯ 3ï¼šæ€§èƒ½ä¼˜åŒ–

1. å¯ç”¨è°ƒè¯•è¿½è¸ª
2. åˆ†æå·¥å…·è°ƒç”¨è€—æ—¶
3. è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
4. ä¼˜åŒ–æ…¢é€Ÿæ“ä½œ
5. éªŒè¯ä¼˜åŒ–æ•ˆæœ

### åœºæ™¯ 4ï¼šé”™è¯¯æ’æŸ¥

1. æŸ¥çœ‹è°ƒè¯•æ—¥å¿—
2. åˆ†æé”™è¯¯äº‹ä»¶
3. è¿½è¸ª Agent å†³ç­–
4. å®šä½é—®é¢˜æ ¹æº
5. ä¿®å¤å¹¶éªŒè¯

## ğŸ¯ å®æˆ˜ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šåˆ›å»º REST API

```
åˆ›å»ºä¸€ä¸ªåšå®¢ API çš„è§„æ ¼ï¼ŒåŒ…å«ï¼š
- è·å–æ–‡ç« åˆ—è¡¨
- è·å–å•ç¯‡æ–‡ç« 
- åˆ›å»ºæ–‡ç« 
- æ›´æ–°æ–‡ç« 
- åˆ é™¤æ–‡ç« 
```

### ç¤ºä¾‹ 2ï¼šç”Ÿæˆå®Œæ•´æ¨¡å—

```
ä» blog_api.spec.yaml ç”Ÿæˆ Express è·¯ç”±ä»£ç ï¼ŒåŒ…å«æµ‹è¯•å’Œæ–‡æ¡£
```

### ç¤ºä¾‹ 3ï¼šæ€§èƒ½åˆ†æ

```typescript
// è·å–æ€§èƒ½ç»Ÿè®¡
const { toolStats } = session.summary;

// æ‰¾å‡ºæœ€æ…¢çš„å·¥å…·
const slowTools = Object.entries(toolStats)
  .filter(([, stats]) => stats.avgDuration > 1000)
  .sort((a, b) => b[1].avgDuration - a[1].avgDuration);

console.log('æ…¢é€Ÿå·¥å…·:', slowTools);
```

## ğŸ”§ é…ç½®é€‰é¡¹

### Agent é…ç½®

```typescript
const executor = new AgentExecutor({
  sessionId: 'session-123',
  workspacePath: './workspace',
  llmClient: llmClient,
  maxIterations: 10,
  enableDebug: true  // å¯ç”¨è°ƒè¯•
});
```

### ä»£ç ç”Ÿæˆé…ç½®

```typescript
const options: CodeGenerationOptions = {
  language: 'typescript',      // æˆ– 'python', 'javascript'
  includeTests: true,          // ç”Ÿæˆæµ‹è¯•
  includeDocumentation: true,  // ç”Ÿæˆæ–‡æ¡£
  style: 'functional'          // æˆ– 'oop'
};
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

åŸºäºè°ƒè¯•è¿½è¸ªçš„å…¸å‹æ€§èƒ½æ•°æ®ï¼š

| æ“ä½œ | å¹³å‡è€—æ—¶ | Token ä½¿ç”¨ |
|------|---------|-----------|
| åˆ›å»ºç®€å•è§„æ ¼ | 2-3s | 500-800 |
| ç”Ÿæˆ TypeScript ä»£ç  | 1-2s | 300-500 |
| ç”Ÿæˆ Python ä»£ç  | 1-2s | 300-500 |
| è¯»å–æ–‡ä»¶ | <100ms | 0 |
| å†™å…¥æ–‡ä»¶ | <200ms | 0 |

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šè§„æ ¼éªŒè¯å¤±è´¥

**åŸå› ï¼š** è§„æ ¼æ ¼å¼ä¸æ­£ç¡®

**è§£å†³ï¼š**
```
éªŒè¯ mymodule.spec.yamlï¼Œå‘Šè¯‰æˆ‘æœ‰ä»€ä¹ˆé—®é¢˜
```

### é—®é¢˜ 2ï¼šä»£ç ç”Ÿæˆå¤±è´¥

**åŸå› ï¼š** è¾“å‡ºè·¯å¾„ä¸å­˜åœ¨

**è§£å†³ï¼š** ç¡®ä¿è¾“å‡ºç›®å½•å·²åˆ›å»ºï¼Œæˆ–è®© Agent è‡ªåŠ¨åˆ›å»º

### é—®é¢˜ 3ï¼šè°ƒè¯•æ•°æ®çœ‹ä¸åˆ°

**åŸå› ï¼š** æœªå¯ç”¨è°ƒè¯•è¿½è¸ª

**è§£å†³ï¼š** è®¾ç½® `enableDebug: true`

## ğŸ“– æ–‡æ¡£å¯¼èˆª

- [SDD è¯¦ç»†æŒ‡å—](./docs/SDD_GUIDE.md) - æ·±å…¥äº†è§£è§„æ ¼é©±åŠ¨å¼€å‘
- [è°ƒè¯•è¿½è¸ªæŒ‡å—](./docs/DEBUG_GUIDE.md) - æŒæ¡è°ƒè¯•è¿½è¸ªç³»ç»Ÿ
- [ç¤ºä¾‹è¯´æ˜](./examples/EXAMPLES.md) - æŸ¥çœ‹å®é™…ä½¿ç”¨ç¤ºä¾‹

## ğŸ“ å­¦ä¹ è·¯å¾„

1. **å…¥é—¨ï¼ˆ5åˆ†é’Ÿï¼‰**
   - é˜…è¯»æœ¬æ–‡æ¡£
   - å°è¯•åˆ›å»ºä¸€ä¸ªç®€å•è§„æ ¼
   - ç”Ÿæˆä»£ç å¹¶æŸ¥çœ‹ç»“æœ

2. **è¿›é˜¶ï¼ˆ20åˆ†é’Ÿï¼‰**
   - é˜…è¯» [SDD æŒ‡å—](./docs/SDD_GUIDE.md)
   - å­¦ä¹ è§„æ ¼æ–‡ä»¶çš„å®Œæ•´è¯­æ³•
   - å°è¯•ç”Ÿæˆå¤æ‚æ¨¡å—

3. **é«˜çº§ï¼ˆ1å°æ—¶ï¼‰**
   - é˜…è¯» [è°ƒè¯•æŒ‡å—](./docs/DEBUG_GUIDE.md)
   - å¯ç”¨è°ƒè¯•è¿½è¸ª
   - åˆ†ææ€§èƒ½æ•°æ®
   - ä¼˜åŒ–å·¥ä½œæµç¨‹

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ï¼ä½ å¯ä»¥ï¼š

1. æäº¤è§„æ ¼æ¨¡æ¿
2. æ”¹è¿›ä»£ç ç”Ÿæˆå™¨
3. å¢åŠ æ–°çš„ç¼–ç¨‹è¯­è¨€æ”¯æŒ
4. å®Œå–„æ–‡æ¡£å’Œç¤ºä¾‹

## ğŸ“„ è®¸å¯è¯

MIT License

---

**æç¤ºï¼š** åœ¨ AI Agent ä¸­è¯¢é—®ä»»ä½•é—®é¢˜ï¼Œå®ƒä¼šå¸®ä½ ä½¿ç”¨è¿™äº›åŠŸèƒ½ï¼

```
å¦‚ä½•ä½¿ç”¨ SDDï¼Ÿ
å¦‚ä½•æŸ¥çœ‹è°ƒè¯•ä¿¡æ¯ï¼Ÿ
å¦‚ä½•ä¼˜åŒ–æ€§èƒ½ï¼Ÿ
```

